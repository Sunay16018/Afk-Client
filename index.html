<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MC Pro Terminal</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="app-container">
        <div class="status-bar">
            <span>‚ù§Ô∏è <span id="h">20</span></span>
            <span>üçó <span id="f">20</span></span>
            <span>üìç <span id="p">0,0,0</span></span>
        </div>

        <div class="login-row">
            <input type="text" id="host" placeholder="Sunucu IP">
            <input type="text" id="user" placeholder="ƒ∞sim">
            <select id="ver">
                <option value="1.8.8">1.8.8</option>
                <option value="1.16.5">1.16.5</option>
                <option value="1.20.1" selected>1.20.1</option>
                <option value="1.21">1.21</option>
            </select>
            <button onclick="connectBot()">Gƒ∞Rƒ∞≈û</button>
        </div>
        
        <div class="log-container">
            <div id="logbox" class="log-window"></div>
        </div>

        <div class="chat-row">
            <input type="text" id="msg" placeholder="Mesaj veya komut...">
            <button onclick="sendMsg()">></button>
        </div>
    </div>

    <script>
        let autoScroll = true;

        async function connectBot() {
            const h = document.getElementById('host').value;
            const u = document.getElementById('user').value;
            const v = document.getElementById('ver').value;
            await fetch(`/start?host=${h}&user=${u}&ver=${v}`);
        }

        async function sendMsg() {
            const input = document.getElementById('msg');
            await fetch(`/send?msg=${encodeURIComponent(input.value)}`);
            input.value = '';
        }

        // Verileri Okuma ve Aray√ºz√º G√ºncelleme
        setInterval(async () => {
            try {
                const res = await fetch('/getdata');
                const data = await res.json();
                
                // Durum √ßubuƒüu
                document.getElementById('h').innerText = data.status.health;
                document.getElementById('f').innerText = data.status.food;
                document.getElementById('p').innerText = `${data.status.pos.x},${data.status.pos.y},${data.status.pos.z}`;

                // Renkli Loglar
                const lb = document.getElementById('logbox');
                lb.innerHTML = data.logs.join('<br>');
                
                if (autoScroll) lb.scrollTop = lb.scrollHeight;
            } catch(e) {}
        }, 1000);

        document.getElementById('logbox').addEventListener('scroll', (e) => {
            const el = e.target;
            autoScroll = (el.scrollHeight - el.scrollTop - el.clientHeight < 30);
        });
    </script>
</body>
</html>

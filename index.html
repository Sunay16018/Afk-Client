<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AFK BOT PRO</title>
    <link rel="manifest" href="/manifest.json">
    <script src="/socket.io/socket.io.js"></script>
    <style>
        * { box-sizing: border-box; font-family: 'Segoe UI', sans-serif; user-select: none; }
        body { background: #000; color: #fff; margin: 0; overflow: hidden; }
        
        /* MenÃ¼ */
        .menu { display: flex; background: #080808; border-bottom: 2px solid #2ecc71; height: 60px; }
        .menu-btn { flex: 1; border: none; background: none; color: #444; font-weight: bold; cursor: pointer; }
        .menu-btn.active { color: #2ecc71; background: rgba(46, 204, 113, 0.1); border-bottom: 3px solid #2ecc71; }

        /* Sekmeler */
        .tab { display: none; height: calc(100vh - 60px); padding: 15px; }
        .tab.active { display: block; animation: fadeIn 0.3s; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* Konsol - Belirgin YeÅŸil Ã‡erÃ§eve */
        #console { 
            height: 75%; background: #000; border: 3px solid #2ecc71; 
            border-radius: 12px; padding: 12px; overflow-y: auto; 
            font-family: monospace; font-size: 14px; box-shadow: 0 0 20px rgba(46,204,113,0.3);
        }
        .log-system { color: #2ecc71; font-weight: bold; }
        .log-error { color: #ff4757; }
        .log-chat { color: #eccc68; }

        input { width: 100%; padding: 15px; margin-bottom: 10px; background: #111; border: 1px solid #333; color: #2ecc71; border-radius: 8px; }
        .btn { width: 100%; padding: 15px; background: #2ecc71; border: none; border-radius: 8px; font-weight: 900; color: #000; cursor: pointer; }
    </style>
</head>
<body>
    <div class="menu">
        <button class="menu-btn active" onclick="ui.tab('bots', this)">BAÄžLANTI</button>
        <button class="menu-btn" onclick="ui.tab('console', this)">KONSOL</button>
    </div>

    <div id="tab-bots" class="tab active">
        <input type="text" id="h" placeholder="Sunucu IP" value="play.sunucu.com">
        <input type="text" id="u" placeholder="Bot KullanÄ±cÄ± AdÄ±">
        <input type="text" id="v" placeholder="SÃ¼rÃ¼m (Ã–rn: 1.16.5)" value="1.16.5">
        <button class="btn" onclick="app.connect()">SUNUCUYA BAÄžLAN VE KONSOLA GÄ°T</button>
        <div id="bot-list" style="margin-top:20px"></div>
    </div>

    <div id="tab-console" class="tab">
        <div id="console"></div>
        <div style="display:flex; gap:8px; margin-top:10px">
            <input type="text" id="msg" placeholder="Mesaj..." style="margin:0">
            <button class="btn" style="width:70px" onclick="app.send()">></button>
        </div>
    </div>

    <script>
        const sid = localStorage.getItem('sid') || 's' + Math.random().toString(36).substr(2, 9);
        localStorage.setItem('sid', sid);
        const socket = io({ query: { sessionId: sid } });
        let currentBot = null;

        const ui = {
            tab: (id, btn) => {
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.menu-btn').forEach(b => b.classList.remove('active'));
                document.getElementById('tab-' + id).classList.add('active');
                if(btn) btn.classList.add('active');
            }
        };

        const app = {
            connect: () => {
                const h = document.getElementById('h').value, u = document.getElementById('u').value, v = document.getElementById('v').value;
                if(!u) return;
                socket.emit('start-bot', { host: h, user: u, ver: v });
                // Otomatik Konsola Atar:
                ui.tab('console', document.querySelectorAll('.menu-btn')[1]);
            },
            send: () => {
                const m = document.getElementById('msg').value;
                if(currentBot && m) { socket.emit('send-chat', { bot: currentBot, msg: m }); document.getElementById('msg').value = ""; }
            }
        };

        socket.on('update', (d) => {
            document.getElementById('bot-list').innerHTML = d.active.map(n => `
                <div class="btn" style="margin-bottom:8px; background:#111; color:#2ecc71; border:1px solid #2ecc71" 
                onclick="currentBot='${n}'; ui.tab('console', document.querySelectorAll('.menu-btn')[1])">ðŸ¤– ${n} (KONTROL ET)</div>
            `).join('');
            
            if(d.sel && d.logs[d.sel]) {
                currentBot = d.sel;
                const c = document.getElementById('console');
                c.innerHTML = d.logs[currentBot].map(l => `<div class="log-${l.type}">[${l.time}] ${l.text}</div>`).join('');
                c.scrollTop = c.scrollHeight;
            }
        });
    </script>
</body>
</html>

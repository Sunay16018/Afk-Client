<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Multi-AFK Professional v5</title>
    <style>
        * { box-sizing: border-box; font-family: 'Segoe UI', sans-serif; font-size: 13px; }
        body { background: #0d1117; color: #c9d1d9; margin: 0; display: flex; flex-direction: column; height: 100vh; }
        nav { display: flex; background: #161b22; border-bottom: 1px solid #30363d; }
        nav button { flex: 1; padding: 15px; border: none; background: none; color: #8b949e; cursor: pointer; font-weight: bold; }
        nav button.active { color: #2ecc71; border-bottom: 3px solid #2ecc71; background: #1f242c; }
        .tab { display: none; flex: 1; padding: 15px; overflow-y: auto; }
        .active-tab { display: flex; flex-direction: column; }
        #logbox { flex: 1; background: #000; padding: 12px; overflow-y: auto; border: 1px solid #30363d; border-radius: 8px; font-family: 'Consolas', monospace; line-height: 1.6; }
        .bot-card { display: flex; justify-content: space-between; align-items: center; padding: 12px; background: #161b22; border: 1px solid #30363d; margin-top: 8px; border-radius: 6px; }
        .btn-stop { background: #da3633; color: white; border: none; padding: 6px 12px; border-radius: 4px; cursor: pointer; }
        .inv-grid { display: grid; grid-template-columns: repeat(9, 1fr); gap: 5px; margin: 0 auto; background: #8b8b8b; padding: 10px; border: 3px solid #373737; }
        .slot { width: 35px; height: 35px; background: #8b8b8b; border: 2px solid #373737; display: flex; align-items: center; justify-content: center; }
        input, select { background: #010409; border: 1px solid #30363d; color: #fff; padding: 12px; border-radius: 6px; margin-bottom: 8px; width: 100%; }
        .btn-add { background: #238636; color: white; width: 100%; padding: 12px; border: none; border-radius: 6px; font-weight: bold; cursor: pointer; }
    </style>
</head>
<body>
    <nav>
        <button onclick="tab('bots')" id="btn-bots" class="active">KONTROL PANELƒ∞</button>
        <button onclick="tab('term')" id="btn-term">SOHBET LOG</button>
        <button onclick="tab('inv')" id="btn-inv">ENVANTER</button>
    </nav>

    <div id="tab-bots" class="tab active-tab">
        <div style="background:#161b22; padding:15px; border-radius:8px; border:1px solid #30363d;">
            <input id="h" placeholder="Sunucu IP (oyna.sunucu.com)">
            <input id="u" placeholder="Bot ƒ∞smi">
            <input id="v" placeholder="S√ºr√ºm (1.20.1)">
            <button class="btn-add" onclick="add()">BOTU SOK</button>
        </div>
        <div id="list"></div>
    </div>

    <div id="tab-term" class="tab">
        <div id="logbox"></div>
        <div style="display:flex; gap:10px; margin-top:10px;">
            <input id="m" style="margin:0" placeholder="Mesaj g√∂nder..." onkeydown="if(event.key==='Enter') send()">
            <button onclick="send()" class="btn-add" style="width:100px; background:#1f6feb;">G√ñNDER</button>
        </div>
    </div>

    <div id="tab-inv" class="tab">
        <div id="stats" style="text-align:center; margin-bottom:10px; font-weight:bold;">‚ù§Ô∏è - | üçñ -</div>
        <div class="inv-grid" id="inv-box"></div>
    </div>

    <script>
        const mySID = "sid_" + Math.random().toString(36).substr(2,9);
        let sel = "";

        function tab(t) {
            document.querySelectorAll('.tab').forEach(x => x.classList.remove('active-tab'));
            document.querySelectorAll('nav button').forEach(x => x.classList.remove('active'));
            document.getElementById('tab-'+t).classList.add('active-tab');
            document.getElementById('btn-'+t).classList.add('active');
        }

        async function add() {
            const h = document.getElementById('h').value, u = document.getElementById('u').value, v = document.getElementById('v').value;
            if(!h || !u) return alert("Eksik bilgi!");
            sel = u;
            await fetch(`/start?sid=${mySID}&host=${h}&user=${u}&ver=${v}`);
            tab('term');
        }

        async function stop(name) {
            await fetch(`/stop?sid=${mySID}&user=${name}`);
            if(sel === name) sel = "";
        }

        async function send() {
            const i = document.getElementById('m');
            if(!sel || !i.value) return;
            await fetch(`/send?sid=${mySID}&user=${sel}&msg=${encodeURIComponent(i.value)}`);
            i.value = "";
        }

        setInterval(async () => {
            try {
                const r = await fetch(`/data?sid=${mySID}&user=${sel}`);
                const d = await r.json();
                
                // Bot Listesi G√ºncelleme
                document.getElementById('list').innerHTML = d.active.map(n => `
                    <div class="bot-card" style="border-color:${sel==n?'#2ecc71':'#30363d'}" onclick="sel='${n}'">
                        <span><b>${n}</b> ${sel==n?'<small style="color:#2ecc71">(SE√áƒ∞LDƒ∞)</small>':''}</span>
                        <button class="btn-stop" onclick="event.stopPropagation(); stop('${n}')">X</button>
                    </div>
                `).join('');

                if(sel && d.logs[sel]) {
                    const lb = document.getElementById('logbox');
                    lb.innerHTML = d.logs[sel].join('<br>');
                    lb.scrollTop = lb.scrollHeight;

                    if(d.botData[sel]) {
                        const bd = d.botData[sel];
                        document.getElementById('stats').innerText = `‚ù§Ô∏è ${Math.round(bd.hp)} | üçñ ${Math.round(bd.food)}`;
                        let invH = "";
                        for(let i=0; i<45; i++) {
                            const it = bd.inv.find(x => x.slot === i);
                            invH += `<div class="slot">${it ? `<img src="https://raw.githubusercontent.com/PrismarineJS/minecraft-assets/master/data/1.16.1/items/${it.name}.png" style="width:26px;">` : ''}</div>`;
                        }
                        document.getElementById('inv-box').innerHTML = invH;
                    }
                }
            } catch(e) {}
        }, 200); // 200ms kalite ve performans dengesi
    </script>
</body>
</html>

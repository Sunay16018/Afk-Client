<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>BotMaster Lite</title>
    <style>
        :root { --bg: #0c0c0e; --p: #16161a; --b: #2d2d33; --a: #6366f1; --t: #f4f4f5; --g: #10b981; }
        * { box-sizing: border-box; outline: none; }
        body { background: var(--bg); color: var(--t); margin: 0; font-family: sans-serif; height: 100vh; display: flex; flex-direction: column; align-items: center; }
        
        nav { display: flex; background: var(--p); height: 45px; border-bottom: 2px solid var(--b); gap: 4px; padding: 4px; width: 100%; max-width: 450px; }
        nav button { flex: 1; background: #232329; border: none; color: #888; border-radius: 5px; font-weight: bold; cursor: pointer; font-size: 10px; }
        nav button.active { background: var(--a); color: white; }

        .tab { display: none; padding: 10px; width: 100%; max-width: 450px; flex: 1; overflow-y: auto; }
        .tab.show { display: flex; flex-direction: column; }

        .card { background: var(--p); border: 1px solid var(--b); border-radius: 8px; padding: 12px; margin-bottom: 10px; }
        .card input { width: 100%; padding: 10px; background: #000; border: 1px solid var(--b); color: #fff !important; border-radius: 5px; margin-top: 5px; font-size: 13px; }
        
        /* ORTA BOYUTLU TERMINAL DÜZENİ */
        .console-wrapper {
            display: flex; flex-direction: column;
            width: 100%; border: 2px solid var(--b); border-radius: 10px; overflow: hidden;
            background: #000;
        }
        #logs { 
            height: 250px; /* BOYUT KÜÇÜLTÜLDÜ (ORTA BOYUT) */
            overflow-y: auto; padding: 10px; font-family: monospace; 
            font-size: 12px; line-height: 1.4; background: #000;
        }
        .log-row { margin-bottom: 2px; white-space: pre-wrap; word-break: break-all; border-bottom: 1px solid #111; }

        .chat-bar { 
            display: flex; background: #1a1a1e; padding: 6px; gap: 5px; border-top: 1px solid var(--b);
        }
        .chat-bar input { 
            flex: 1; background: #000; border: 1px solid var(--b); 
            color: #fff; padding: 8px; border-radius: 4px; font-size: 13px;
        }
        .chat-bar button { background: var(--a); color: white; border: none; padding: 0 12px; border-radius: 4px; cursor: pointer; font-weight: bold; font-size: 12px; }

        .inv-grid { display: grid; grid-template-columns: repeat(9, 1fr); gap: 2px; }
        .slot { aspect-ratio: 1; background: #111; border: 1px solid var(--b); display: flex; align-items: center; justify-content: center; }
        .slot img { width: 80%; image-rendering: pixelated; }

        .btn { background: var(--a); color: white; border: none; padding: 10px; border-radius: 5px; cursor: pointer; font-weight: bold; width: 100%; margin-top: 5px; font-size: 12px; }
    </style>
</head>
<body>
    <nav>
        <button onclick="tab('bots', this)" class="active">GİRİŞ</button>
        <button onclick="tab('console', this)">KONSOL</button>
        <button onclick="tab('status', this)">DURUM</button>
        <button onclick="tab('settings', this)">AYARLAR</button>
    </nav>

    <div id="p-bots" class="tab show">
        <div class="card">
            <input id="ip" placeholder="ip:port">
            <input id="usr" placeholder="Bot İsmi">
            <button onclick="connect()" class="btn" style="background:var(--g)">BAĞLAN</button>
        </div>
        <div id="blist"></div>
    </div>

    <div id="p-console" class="tab">
        <div class="console-wrapper">
            <div id="logs"></div>
            <div class="chat-bar">
                <input id="msg" placeholder="Mesaj..." onkeydown="if(event.key==='Enter') send()">
                <button onclick="send()">></button>
            </div>
        </div>
    </div>

    <div id="p-status" class="tab">
        <div class="card">Can: <span id="hp">20</span> | Açlık: <span id="fd">20</span></div>
        <div class="inv-grid" id="inv"></div>
    </div>

    <div id="p-settings" class="tab">
        <div class="card">
            <b>Oto Mesaj</b>
            <input id="mtxt" placeholder="Metin...">
            <input id="msec" type="number" value="10" style="width:60px"> sn
            <button id="mbtn" class="btn" onclick="toggleSpam()">SPAM BAŞLAT</button>
        </div>
        <div style="display:grid; grid-template-columns: 1fr 1fr; gap:5px;">
            <button class="btn" onmousedown="mv('forward','on')" onmouseup="mv('forward','off')">İLERİ</button>
            <button class="btn" onmousedown="mv('back','on')" onmouseup="mv('back','off')">GERİ</button>
            <button class="btn" onclick="lk('left')">SOLA BAK</button>
            <button class="btn" onclick="lk('right')">SAĞA BAK</button>
        </div>
    </div>

    <script>
        let sel = null; let botLogs = {}; let spamOn = false;
        function tab(id, b) {
            document.querySelectorAll('.tab').forEach(t=>t.classList.remove('show'));
            document.querySelectorAll('nav button').forEach(n=>n.classList.remove('active'));
            document.getElementById('p-'+id).classList.add('show');
            b.classList.add('active');
        }
        async function connect() {
            const h=document.getElementById('ip').value, u=document.getElementById('usr').value;
            if(!h||!u) return; await fetch(`/start?host=${h}&user=${u}`);
            sel=u; botLogs[u]=[]; tab('console', document.querySelectorAll('nav button')[1]);
        }
        async function send() {
            const m=document.getElementById('msg'); if(!sel||!m.value) return;
            fetch(`/send?user=${sel}&msg=${encodeURIComponent(m.value)}`); m.value='';
        }
        function mv(v, s) { if(sel) fetch(`/update?user=${sel}&type=move&val=${v}&status=${s}`); }
        function lk(v) { if(sel) fetch(`/update?user=${sel}&type=look&val=${v}`); }
        function toggleSpam() {
            if(!sel) return; spamOn = !spamOn;
            const b=document.getElementById('mbtn'), t=document.getElementById('mtxt').value, s=document.getElementById('msec').value;
            b.innerText = spamOn ? 'DURDUR' : 'SPAM BAŞLAT';
            b.style.background = spamOn ? '#ef4444' : '#6366f1';
            fetch(`/update?user=${sel}&type=auto_msg&status=${spamOn?'on':'off'}&val=${t}|${s}`);
        }
        setInterval(async () => {
            const r=await fetch(`/data?user=${sel||''}`); const d=await r.json();
            document.getElementById('blist').innerHTML = d.active.map(b=>`<div class="card" style="padding:8px; cursor:pointer; border-color:${sel===b?'var(--a)':'var(--b)'}" onclick="sel='${b}'">${b}</div>`).join('');
            if(sel && d.botData[sel]) {
                const b = d.botData[sel];
                if(b.logs.length > 0) {
                    const lb = document.getElementById('logs');
                    b.logs.forEach(msg => { const div = document.createElement('div'); div.className = 'log-row'; div.innerHTML = msg; lb.appendChild(div); });
                    lb.scrollTop = lb.scrollHeight;
                }
                document.getElementById('hp').innerText = Math.round(b.health);
                document.getElementById('fd').innerText = Math.round(b.food);
                const iG = document.getElementById('inv'); iG.innerHTML = '';
                for(let i=9; i<45; i++) {
                    const it = b.inventory.find(x=>x.slot===i);
                    iG.innerHTML += `<div class="slot">${it?`<img src="https://raw.githubusercontent.com/PrismarineJS/minecraft-assets/master/data/1.16.1/items/${it.name}.png">`:''}</div>`;
                }
            }
        }, 1000);
    </script>
</body>
</html>

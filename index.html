<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MC Master Panel</title>
    <style>
        * { box-sizing: border-box; user-select: none; font-family: sans-serif; }
        body { margin: 0; background: #000; color: #fff; height: 100vh; display: flex; flex-direction: column; overflow: hidden; }
        nav { display: flex; background: #111; border-bottom: 1px solid #333; flex-shrink: 0; }
        nav button { flex: 1; padding: 15px; background: none; border: none; color: #fff; font-weight: bold; }
        nav button.active { border-bottom: 3px solid #2ecc71; color: #2ecc71; }
        
        .tab { display: none; flex: 1; overflow-y: auto; padding: 10px; }
        .active-tab { display: flex; flex-direction: column; }

        .control-group { background: #111; padding: 10px; border-radius: 8px; margin-bottom: 10px; border: 1px solid #222; }
        .control-group h4 { margin: 0 0 8px 0; font-size: 13px; color: #2ecc71; }
        
        input, select { width: 100%; padding: 10px; margin: 4px 0; border-radius: 5px; border: 1px solid #333; background: #000; color: #fff; font-size: 12px; }
        .row { display: flex; gap: 5px; align-items: center; }
        
        button { cursor: pointer; border-radius: 5px; font-weight: bold; }
        .btn-on { background: #2ecc71; border: none; color: #fff; padding: 8px; flex: 1; }
        .btn-off { background: #e74c3c; border: none; color: #fff; padding: 8px; flex: 1; }
        
        #logbox { flex: 1; background: #050505; padding: 10px; font-family: monospace; font-size: 11px; border: 1px solid #222; overflow-y: auto; margin: 10px 0; }
        .bot-card { padding: 12px; background: #111; margin-bottom: 5px; border-radius: 5px; border: 1px solid #333; text-align: center; }
        .selected { border-color: #2ecc71; background: #16221a; }
    </style>
</head>
<body>

    <nav>
        <button onclick="tab('bots')" id="btn-bots" class="active">BOTLAR</button>
        <button onclick="tab('term')" id="btn-term">KONTROL & KONSOL</button>
    </nav>

    <div id="tab-bots" class="tab active-tab">
        <input id="h" placeholder="Sunucu IP (√ñrn: play.pixel.net)">
        <input id="u" placeholder="Bot ƒ∞smi">
        <select id="v">
            <option value="1.8.8">1.8.8</option>
            <option value="1.20.1" selected>1.20.1</option>
            <option value="1.21.1">1.21.1</option>
        </select>
        <button onclick="add()" style="width:100%; padding:15px; background:#2ecc71; border:none; color:#fff; border-radius:5px; font-weight:bold; margin-top:10px;">BAƒûLAN</button>
        <div id="list" style="margin-top:15px;"></div>
    </div>

    <div id="tab-term" class="tab">
        <div style="font-size:14px; margin-bottom:10px;">Se√ßili: <b id="cur" style="color:#2ecc71">YOK</b></div>
        
        <div class="control-group">
            <h4>üí¨ Otomatik Mesaj</h4>
            <input id="cfg_msg_text" placeholder="Mesaj i√ßeriƒüi...">
            <div class="row">
                <input id="cfg_msg_sec" type="number" placeholder="Saniye" style="width:70px">
                <button class="btn-on" onclick="upd('msg','on')">A√á</button>
                <button class="btn-off" onclick="upd('msg','off')">KAPAT</button>
            </div>
        </div>

        <div class="control-group">
            <h4>üñ±Ô∏è Otomatik Saƒü Tƒ±k</h4>
            <div class="row">
                <input id="cfg_click_sec" type="number" placeholder="Saniye" style="width:70px">
                <button class="btn-on" onclick="upd('click','on')">A√á</button>
                <button class="btn-off" onclick="upd('click','off')">KAPAT</button>
            </div>
        </div>

        <div class="control-group">
            <h4>‚õèÔ∏è Otomatik Kƒ±rma</h4>
            <div class="row">
                <button class="btn-on" onclick="upd('break','on')">KIRMAYI BA≈ûLAT</button>
                <button class="btn-off" onclick="upd('break','off')">DURDUR</button>
            </div>
        </div>

        <div id="logbox"></div>

        <div class="row">
            <input id="m" placeholder="Sohbete yaz..." style="margin:0; flex:1;">
            <button onclick="send()" style="padding:10px 20px; background:#2ecc71; border:none; color:#fff; border-radius:5px;">G√ñNDER</button>
        </div>
    </div>

    <script>
        let sel = "";
        function tab(t) {
            document.querySelectorAll('.tab').forEach(x => x.classList.remove('active-tab'));
            document.querySelectorAll('nav button').forEach(x => x.classList.remove('active'));
            document.getElementById('tab-'+t).classList.add('active-tab');
            document.getElementById('btn-'+t).classList.add('active');
        }

        async function add() {
            const h = document.getElementById('h').value;
            const u = document.getElementById('u').value;
            const v = document.getElementById('v').value;
            if(!u || !h) return;
            await fetch(`/start?host=${h}&user=${u}&ver=${v}`);
            sel = u; document.getElementById('cur').innerText = u;
            tab('term');
        }

        async function upd(type, status) {
            if(!sel) return alert("Bot se√ß!");
            let val = "";
            let sec = 0;
            if(type === 'msg') {
                val = encodeURIComponent(document.getElementById('cfg_msg_text').value);
                sec = document.getElementById('cfg_msg_sec').value || 30;
            }
            if(type === 'click') {
                sec = document.getElementById('cfg_click_sec').value || 5;
            }
            await fetch(`/update?user=${sel}&type=${type}&status=${status}&val=${val}&sec=${sec}`);
        }

        async function send() {
            const m = document.getElementById('m');
            if(!sel || !m.value) return;
            await fetch(`/send?user=${sel}&msg=${encodeURIComponent(m.value)}`);
            m.value = "";
        }

        setInterval(async () => {
            const r = await fetch('/data');
            const d = await r.json();
            document.getElementById('list').innerHTML = d.active.map(n => `
                <div class="bot-card ${sel==n?'selected':''}" onclick="sel='${n}'; document.getElementById('cur').innerText='${n}'">${n}</div>
            `).join('');
            if(sel && d.logs[sel]) {
                const lb = document.getElementById('logbox');
                lb.innerHTML = d.logs[sel].join('<br>');
                lb.scrollTop = lb.scrollHeight;
            }
        }, 1000);
    </script>
</body>
</html>

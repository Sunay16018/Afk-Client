<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AFK BASİT</title>
    <style>
        body { background: #0d1117; color: #fff; font-family: sans-serif; margin: 0; padding: 10px; }
        .box { background: #161b22; border: 1px solid #30363d; padding: 15px; border-radius: 10px; margin-bottom: 10px; }
        input { background: #010409; border: 1px solid #30363d; color: #fff; padding: 10px; width: 100%; margin: 5px 0; border-radius: 5px; }
        button { background: #238636; color: #fff; border: none; padding: 10px; width: 100%; border-radius: 5px; cursor: pointer; font-weight: bold; }
        #log { background: #000; height: 300px; overflow-y: auto; padding: 10px; font-size: 12px; border-radius: 5px; border: 1px solid #333; }
        .red { background: #da3633; }
        .blue { background: #1f6feb; }
    </style>
</head>
<body>
    <div class="box">
        <b>BOT GİRİŞİ</b>
        <input id="h" placeholder="IP:Port">
        <input id="u" placeholder="İsim">
        <input id="v" placeholder="Sürüm (Örn: 1.16.5)">
        <button onclick="start()">BAĞLAN</button>
    </div>

    <div class="box">
        <b>SPAM AYARI</b>
        <input id="sm" placeholder="Yazılacak Mesaj">
        <input id="ss" type="number" placeholder="Saniye (0 = Durdur)">
        <button class="blue" onclick="setSpam()">SPAM GÜNCELLE</button>
    </div>

    <div id="active_bots"></div>
    <div id="log"></div>

    <script>
        let sel = "";

        async function start() {
            const h=document.getElementById('h').value, u=document.getElementById('u').value, v=document.getElementById('v').value;
            await fetch(`/start?host=${h}&user=${u}&ver=${v}`);
            sel = u;
        }

        async function setSpam() {
            const m = document.getElementById('sm').value;
            const s = document.getElementById('ss').value;
            if(!sel) return alert("Önce botu başlat!");
            await fetch(`/set_spam?user=${sel}&msg=${encodeURIComponent(m)}&sec=${s}`);
        }

        setInterval(async () => {
            try {
                const r = await fetch('/data');
                const d = await r.json();
                
                if (sel && d.logs[sel]) {
                    document.getElementById('log').innerHTML = d.logs[sel].join('<br>');
                }

                document.getElementById('active_bots').innerHTML = d.active.map(b => `
                    <div class="box" style="border-color:#2ecc71">
                        <b>${b}</b> 
                        <button class="red" onclick="fetch('/stop?user=${b}')" style="width:80px; float:right; padding:5px">DURDUR</button>
                    </div>
                `).join('');
            } catch(e) {}
        }, 2000);
    </script>
</body>
</html>
